<!DOCTYPE html>
<html lang="en-US">
<head>
    <script>
        function createTable(latitude,longitude,lst,beta,gamma){
            var table=document.getElementsByTagName("tbody").item(1);
            var n=1;
            for(var i=1;i<=365;i++){
                var tr=document.createElement('tr');
                var td=document.createElement('td');
                td.innerHTML="Day "+i+": ";
                tr.appendChild(td);

                var td=document.createElement('td');
                n=i;
                td.innerHTML=getH0(getGSC(),n,getPhi(latitude),getDelta(n),getOmega_s(getPhi(latitude),getDelta(n))).toPrecision(12);
                tr.appendChild(td);
                table.appendChild(tr);
            }
        }
        function degToRad(deg){
            return (Math.PI * deg / 180);
        }
        function radToDeg(rad){
            return (180 * rad / Math.PI);
        }
        function getPhi(latitude){
            return (latitude);
        }
        function getB(n){
            return ((n-1.0)*(360.0/365.0));
        }
        function getDelta(n){
            return 23.45*Math.sin(degToRad(((360.0/365.0)*(284.0+n))));
        }
        function getE(B){
            return 229.2*(0.000075+0.001868*Math.cos(degToRad(B))-0.032077*Math.sin(degToRad(B))-0.014615*Math.cos(degToRad(2.0*B))-0.04089*Math.sin(degToRad(2.0*B)));
        }
        function getSolar_time(lst,longitude,e,local_time){
            return (4.0*(lst-(360.0-longitude))+e)/60+local_time;
        }
        function getOmega(solar_time){
            return (solar_time-12.0)*15.0;
        }
        function getTheta(delta,phi,beta,gamma,omega){
            var t1=Math.sin(degToRad(delta))*Math.sin(degToRad(phi))*Math.cos(degToRad(beta));
            var t2=Math.sin(degToRad(delta))*Math.cos(degToRad(phi))*Math.sin(degToRad(beta))*Math.cos(degToRad(gamma));
            var t3=Math.cos(degToRad(delta))*Math.cos(degToRad(phi))*Math.cos(degToRad(beta))*Math.cos(degToRad(omega));
            var t4=Math.cos(degToRad(delta))*Math.sin(degToRad(phi))*Math.sin(degToRad(beta))*Math.cos(degToRad(gamma))*Math.cos(degToRad(omega));
            var t5=Math.cos(degToRad(delta))*Math.sin(degToRad(beta))*Math.sin(degToRad(gamma))*Math.sin(degToRad(omega));

            return radToDeg(Math.acos(t1-t2+t3+t4+t5));
        }
        function getGSC(){
            return 1367;
        }
        function getOmega_s(phi,delta){
            return radToDeg(Math.acos(-Math.tan(degToRad(phi))*Math.tan(degToRad(delta))))
        }
        function getH0(GSC,n,phi,delta,omega_s){
            var h01=((24.0*3600.0)/(1000.0*Math.PI))*GSC;
            var h02=1.0+(0.033*Math.cos(degToRad(360.0*n/365.0)));
            var h03=Math.cos(degToRad(phi))*Math.cos(degToRad(delta))*Math.sin(degToRad(omega_s));
            var h04=(Math.PI*omega_s/180.0)*Math.sin(degToRad(phi))*Math.sin(degToRad(delta));

            return h01*h02*(h03+h04);
        }
        function getI0(GSC,n,delta,phi,omega){
            var i01=(3600.0/(1000.0))*GSC;
            var i02=1.0+(0.033*Math.cos(degToRad(360.0*n/365.0)));
            var i03=Math.cos(degToRad(delta))*Math.cos(degToRad(phi))*Math.cos(degToRad(omega));
            var i04=Math.sin(degToRad(phi))*Math.sin(degToRad(delta));
            return i01*i02*(i03+i04);
        }
        function setup(){
            // Input
            var latitude=document.getElementById('latitude').value;
            var longitude=document.getElementById('longitude').value;
            var lst=360.0-parseFloat(document.getElementById('lst').value);
            var n=document.getElementById('n').value;
            var local_time=document.getElementById('local_time').value;
            var beta=document.getElementById('beta').value;
            var gamma=document.getElementById('gamma').value;

            // Output
            var phi=getPhi(latitude);
            document.getElementById('phi').value=phi;

            var B=getB(n);
            document.getElementById('B').value=B;

            var delta=getDelta(n);
            document.getElementById('delta').value=delta;

            var e=getE(B);
            document.getElementById('e').value=e;

            var solar_time=getSolar_time(lst,longitude,e,local_time);
            document.getElementById('solar_time').value=solar_time;

            var omega=getOmega(solar_time);
            document.getElementById('omega').value=omega;

            var theta=getTheta(delta,phi,beta,gamma,omega);
            document.getElementById('theta').value=theta;

            var GSC=getGSC();
            var omega_s=getOmega_s(phi,delta);
            document.getElementById('omega_s').value=omega_s;

            var H0=getH0(GSC,n,phi,delta,omega_s);
            document.getElementById('H0').value=H0;

            var I0=getI0(GSC,n,delta,phi,omega);
            document.getElementById('I0').value=I0;

            createTable(latitude,longitude,lst,beta,gamma);
        }
    </script>
</head>
<body>
    <h1>SOLAREAM: Solar Energy Apparatus Manager</h1>
    <p>Version 0.1 Preview</p>
    <table>
        <!--INPUT-->
        <tr><td>Latitude</td><td><input id="latitude" type="number" step="0.01" value=23.16></td></tr>
        <tr><td>Longitude</td><td><input id="longitude" type="number" step="0.01" value=72.66></td></tr>
        <tr><td>Standard Meridian of Local</td><td><input id="lst" type="number" step="0.01" value=82.5></td></tr>
        <tr><td>n: Day of Year</td><td><input id="n" type="number" step="1" value=34></td></tr>
        <tr><td>Local Time</td><td><input id="local_time" type="number" step="0.5" value=10.5></td></tr>
        <tr><td>Beta</td><td><input id="beta" type="number" step="0.01" value=30></td></tr>
        <tr><td>&gamma;</td><td><input id="gamma" type="number" step="0.01" value=0></td></tr>

        <!--OUTPUT-->
        <tr><td>B</td><td><input id="B" type="number" step="0.01"></td></tr>
        <tr><td>e</td><td><input id="e" type="number" step="0.01"></td></tr>
        <tr><td>Solar Time</td><td><input id="solar_time" type="number"></td></tr>
        <tr><td>&delta;</td><td><input id="delta" type="number" step="0.01"></td></tr>
        <tr><td>&theta;</td><td><input id="theta" type="number" step="0.01"></td></tr>
        <tr><td>&phi;</td><td><input id="phi" type="number" step="0.01"></td></tr>
        <tr><td>&omega;</td><td><input id="omega" type="number" step="0.01"></td></tr>
        <tr><td>&omega;s</td><td><input id="omega_s" type="number" step="0.01"></td></tr>
        <tr><td>H<sub>0</sub></td><td><input id="H0" type="number" step="0.01"></td></tr>
        <tr><td>I<sub>0</sub></td><td><input id="I0" type="number" step="0.01"></td></tr>
    </table>
    <button onclick="setup()">Calculate</button>
    <table id="sun-table">
        <tbody>
        </tbody>
    </table>
    <div id="H"></div>
</body>
</html>
